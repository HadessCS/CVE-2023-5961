import requests
import argparse

def fetch_relay_information(url):
    try:
        response = requests.get(url)
        if response.status_code == 200:
            relay_info = response.text  # Assuming relay information is in the response body
            print("Relay Information:")
            print(relay_info)
        else:
            print(f"Failed to fetch relay information. Status Code: {response.status_code}")
    except requests.RequestException as e:
        print(f"Error fetching relay information: {e}")

def download_configuration(url):
    try:
        response = requests.get(url + "/ik1212.txt")
        if response.status_code == 200:
            with open("ik1212.txt", "wb") as file:
                file.write(response.content)
            print("Configuration file downloaded successfully.")
        else:
            print(f"Failed to download configuration file. Status Code: {response.status_code}")
    except requests.RequestException as e:
        print(f"Error downloading configuration file: {e}")

def main():
    parser = argparse.ArgumentParser(description="Moxa ioLogik E1212 Script")
    parser.add_argument("--url", default="http://localhost", help="URL of the ioLogik E1212 device (default: http://localhost)")
    parser.add_argument("--conf", action="store_true", help="Download configuration file /ik1212.txt")
    args = parser.parse_args()

    if args.conf:
        download_configuration(args.url)
    else:
        fetch_relay_information(args.url)

if __name__ == "__main__":
    main()

